<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberShield | Report Threat</title>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            dark: '#050b14',
                            blue: '#00f0ff',
                            purple: '#bd00ff',
                            red: '#ff003c',
                            glass: 'rgba(255, 255, 255, 0.05)'
                        }
                    },
                    animation: {
                        'spin-slow': 'spin 10s linear infinite',
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fadeIn': 'fadeIn 0.5s ease-out',
                        'fadeOut': 'fadeOut 0.5s ease-out',
                        'slideUp': 'slideUp 0.4s ease-out',
                        'slideDown': 'slideDown 0.4s ease-out',
                        'progressBar': 'progressBar 2s ease-out forwards',
                        'shimmer': 'shimmer 2s linear infinite',
                        'glow': 'glow 2s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        },
                        fadeOut: {
                            '0%': { opacity: '1' },
                            '100%': { opacity: '0' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        slideDown: {
                            '0%': { transform: 'translateY(-20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        progressBar: {
                            '0%': { width: '0%' },
                            '100%': { width: '100%' }
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-1000px 0' },
                            '100%': { backgroundPosition: '1000px 0' }
                        },
                        glow: {
                            '0%, 100%': { opacity: '1', filter: 'drop-shadow(0 0 10px rgba(0, 240, 255, 0.5))' },
                            '50%': { opacity: '0.8', filter: 'drop-shadow(0 0 20px rgba(0, 240, 255, 0.8))' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Outfit:wght@300;400;600;800&display=swap');

        body {
            background-color: #030712;
            color: #e2e8f0;
            font-family: 'Outfit', sans-serif;
            overflow-x: hidden;
        }

        .font-mono {
            font-family: 'JetBrains Mono', monospace;
        }

        .cyber-grid {
            position: fixed;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background-image: 
                linear-gradient(transparent 0%, rgba(0, 240, 255, 0.05) 2%, transparent 3%),
                linear-gradient(90deg, transparent 0%, rgba(0, 240, 255, 0.05) 2%, transparent 3%);
            background-size: 50px 50px;
            transform: perspective(500px) rotateX(60deg);
            animation: grid-move 20s linear infinite;
            z-index: -1;
            pointer-events: none;
        }

        @keyframes grid-move {
            0% { transform: perspective(500px) rotateX(60deg) translateY(0); }
            100% { transform: perspective(500px) rotateX(60deg) translateY(50px); }
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
        }

        .glass-panel:hover {
            border-color: rgba(0, 240, 255, 0.3);
            box-shadow: 0 0 20px rgba(0, 240, 255, 0.1);
        }

        .neon-text-blue {
            text-shadow: 0 0 10px rgba(0, 240, 255, 0.5);
        }

        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #0f172a;
        }
        ::-webkit-scrollbar-thumb {
            background: #1e293b;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #00f0ff;
        }

        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.1) 50%,
                rgba(0,0,0,0.1)
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.3;
        }

        .file-upload-area {
            position: relative;
            transition: all 0.3s ease;
        }

        .file-upload-area:hover {
            border-color: rgba(0, 240, 255, 0.5);
            background: rgba(0, 240, 255, 0.05);
        }

        .file-upload-area.dragging {
            border-color: #00f0ff;
            background: rgba(0, 240, 255, 0.1);
        }

        .custom-checkbox {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            background: rgba(0, 0, 0, 0.3);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .custom-checkbox:checked {
            background: #00f0ff;
            border-color: #00f0ff;
        }

        .custom-checkbox:checked::after {
            content: 'âœ“';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #000;
            font-weight: bold;
            font-size: 14px;
        }

        .status-timeline {
            position: relative;
        }

        .status-timeline::before {
            content: '';
            position: absolute;
            left: 19px;
            top: 40px;
            bottom: 20px;
            width: 2px;
            background: rgba(255, 255, 255, 0.1);
        }

        .status-step {
            position: relative;
            padding-left: 60px;
            margin-bottom: 32px;
        }

        .status-icon {
            position: absolute;
            left: 0;
            top: 0;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        .status-step.active .status-icon {
            animation: pulse-fast 2s infinite;
        }

        .progress-line {
            position: absolute;
            left: 19px;
            width: 2px;
            background: linear-gradient(to bottom, #00f0ff, #0099cc);
            z-index: 0;
            box-shadow: 0 0 10px rgba(0, 240, 255, 0.5);
        }

        .tab-button {
            position: relative;
            overflow: hidden;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(to right, #00f0ff, #0099cc);
            box-shadow: 0 0 10px rgba(0, 240, 255, 0.5);
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .captcha-box {
            background: linear-gradient(135deg, rgba(0, 240, 255, 0.1), rgba(0, 153, 204, 0.1));
            border: 2px solid rgba(0, 240, 255, 0.3);
            position: relative;
            overflow: hidden;
        }

        .captcha-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 240, 255, 0.2), transparent);
            animation: shimmer 2s infinite;
        }

        .encryption-badge {
            background: linear-gradient(135deg, rgba(0, 240, 255, 0.2), rgba(0, 153, 204, 0.2));
            border: 1px solid rgba(0, 240, 255, 0.4);
            box-shadow: 0 0 20px rgba(0, 240, 255, 0.2);
        }

        .shield-icon {
            animation: pulse-fast 3s infinite;
        }

        /* Loading Screen Styles */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #030712 0%, #0a1628 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 99999;
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
        }
        
        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loader-rings {
            position: relative;
            width: 120px;
            height: 120px;
        }

        .loader-ring {
            position: absolute;
            border: 3px solid transparent;
            border-radius: 50%;
            animation: rotate 2s linear infinite;
        }

        .loader-ring:nth-child(1) {
            width: 120px;
            height: 120px;
            border-top-color: #00f0ff;
            animation-duration: 2s;
        }

        .loader-ring:nth-child(2) {
            width: 100px;
            height: 100px;
            top: 10px;
            left: 10px;
            border-top-color: #bd00ff;
            animation-duration: 1.5s;
            animation-direction: reverse;
        }

        .loader-ring:nth-child(3) {
            width: 80px;
            height: 80px;
            top: 20px;
            left: 20px;
            border-top-color: #ff003c;
            animation-duration: 1s;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-progress {
            width: 200px;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
            margin-top: 40px;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00f0ff, #bd00ff, #ff003c, #00f0ff);
            background-size: 200% 100%;
            animation: shimmer 2s linear infinite;
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .loading-text {
            color: #00f0ff;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            margin-top: 24px;
            letter-spacing: 2px;
            animation: glow 2s ease-in-out infinite;
        }

        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="flex flex-col items-center">
            <div class="loader-rings">
                <div class="loader-ring"></div>
                <div class="loader-ring"></div>
                <div class="loader-ring"></div>
            </div>
            <div class="loading-progress">
                <div id="loading-progress-bar" class="loading-progress-bar" style="width: 0%"></div>
            </div>
            <div class="loading-text">
                <span id="loading-text">INITIALIZING SYSTEM</span><span class="loading-dots"></span>
            </div>
        </div>
    </div>

    <div class="cyber-grid"></div>
    <div class="scanlines"></div>
    <div id="root"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD74hSR_EipAUN9tvSN8lLe6hGJ6p-UzSM",
            authDomain: "cybershield-fa262.firebaseapp.com",
            databaseURL: "https://cybershield-fa262-default-rtdb.asia-southeast1.firebasedatabase.app/",
            projectId: "cybershield-fa262",
            storageBucket: "cybershield-fa262.firebasestorage.app",
            messagingSenderId: "1095310557329",
            appId: "1:1095310557329:web:b91d2dd48ef112c0fa3f30",
            measurementId: "G-H8LDB4XLB1"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth();

        // Loading Screen Controller
        const loadingSteps = [
            { text: 'INITIALIZING SYSTEM', progress: 20 },
            { text: 'LOADING SECURITY MODULES', progress: 40 },
            { text: 'CONNECTING TO DATABASE', progress: 60 },
            { text: 'PREPARING REPORT FORM', progress: 80 },
            { text: 'READY TO SUBMIT', progress: 100 }
        ];

        let currentStep = 0;

        function updateLoadingScreen() {
            const loadingScreen = document.getElementById('loading-screen');
            const loadingText = document.getElementById('loading-text');
            const progressBar = document.getElementById('loading-progress-bar');

            if (currentStep < loadingSteps.length) {
                const step = loadingSteps[currentStep];
                loadingText.textContent = step.text;
                progressBar.style.width = step.progress + '%';
                currentStep++;
                setTimeout(updateLoadingScreen, 500);
            } else {
                setTimeout(() => {
                    loadingScreen.classList.add('hidden');
                }, 300);
            }
        }

        // Start loading animation
        setTimeout(updateLoadingScreen, 300);
    </script>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const Sidebar = ({ activeTab }) => {
            const menuItems = [
                { id: 'dashboard', icon: 'fa-chart-pie', label: 'Overview', link: 'index.html' },
                { id: 'report', icon: 'fa-file-shield', label: 'Report Threat', link: 'report-page.html' },
                { id: 'admin', icon: 'fa-user-shield', label: 'Admin Panel', link: 'admin-panel.html' },
            ];

            return (
                <div className="w-20 lg:w-64 h-screen fixed left-0 top-0 glass-panel border-r border-white/10 flex flex-col z-50 transition-all duration-300">
                    <div className="p-6 flex items-center gap-3 justify-center lg:justify-start">
                        <i className="fa-solid fa-shield-virus text-3xl text-cyber-blue animate-pulse-fast"></i>
                        <span className="hidden lg:block text-xl font-bold tracking-wider text-white">
                            CYBER<span className="text-cyber-blue">SHIELD</span>
                        </span>
                    </div>

                    <div className="flex-1 py-8 flex flex-col gap-2">
                        {menuItems.map(item => (
                            <a
                                key={item.id}
                                href={item.link}
                                className={`
                                    flex items-center gap-4 px-6 py-4 transition-all duration-300 relative overflow-hidden group
                                    ${activeTab === item.id ? 'text-cyber-blue bg-white/5' : 'text-slate-400 hover:text-white hover:bg-white/5'}
                                `}
                            >
                                {activeTab === item.id && (
                                    <div className="absolute left-0 top-0 bottom-0 w-1 bg-cyber-blue shadow-[0_0_15px_rgba(0,240,255,0.8)]"></div>
                                )}
                                <i className={`fa-solid ${item.icon} text-xl w-6 text-center`}></i>
                                <span className="hidden lg:block font-medium tracking-wide">{item.label}</span>
                            </a>
                        ))}
                    </div>
                </div>
            );
        };

        // Account Settings Modal
        const AccountSettingsModal = ({ onClose }) => {
            return (
                <div className="modal-overlay animate-fadeIn" onClick={onClose}>
                    <div className="modal-content glass-panel rounded-2xl p-6 animate-slideDown" onClick={(e) => e.stopPropagation()}>
                        <div className="flex items-center justify-between mb-4">
                            <h3 className="text-xl font-bold text-white">Account Settings</h3>
                            <button onClick={onClose} className="w-10 h-10 rounded-lg border border-white/20 hover:bg-white/5 transition flex items-center justify-center">
                                <i className="fa-solid fa-xmark"></i>
                            </button>
                        </div>

                        <div className="space-y-4">
                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <p className="text-sm text-slate-300">Manage your profile, change display name, and update email preferences.</p>
                            </div>

                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <label className="block text-xs text-slate-400 mb-2">Display Name</label>
                                <input className="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white" placeholder="Your display name" />
                            </div>

                            <div className="flex gap-3">
                                <button className="flex-1 py-3 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-xl font-bold text-black">Save</button>
                                <button onClick={onClose} className="px-6 py-3 border border-white/20 rounded-xl text-slate-300">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Security Modal
        const SecurityModal = ({ onClose }) => {
            return (
                <div className="modal-overlay animate-fadeIn" onClick={onClose}>
                    <div className="modal-content glass-panel rounded-2xl p-6 animate-slideDown" onClick={(e) => e.stopPropagation()}>
                        <div className="flex items-center justify-between mb-4">
                            <h3 className="text-xl font-bold text-white">Security</h3>
                            <button onClick={onClose} className="w-10 h-10 rounded-lg border border-white/20 hover:bg-white/5 transition flex items-center justify-center">
                                <i className="fa-solid fa-xmark"></i>
                            </button>
                        </div>

                        <div className="space-y-4">
                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <h4 className="font-bold text-white mb-2">Two-Factor Authentication</h4>
                                <p className="text-sm text-slate-300">Enable or disable 2FA for your account to improve security.</p>
                            </div>

                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <h4 className="font-bold text-white mb-2">Recent Activity</h4>
                                <p className="text-sm text-slate-300">View recent login attempts and active sessions.</p>
                            </div>

                            <div className="flex gap-3">
                                <button className="flex-1 py-3 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-xl font-bold text-black">Manage</button>
                                <button onClick={onClose} className="px-6 py-3 border border-white/20 rounded-xl text-slate-300">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Notifications Modal
        const NotificationsModal = ({ onClose }) => {
            return (
                <div className="modal-overlay animate-fadeIn" onClick={onClose}>
                    <div className="modal-content glass-panel rounded-2xl p-6 animate-slideDown" onClick={(e) => e.stopPropagation()}>
                        <div className="flex items-center justify-between mb-4">
                            <h3 className="text-xl font-bold text-white">Notifications</h3>
                            <button onClick={onClose} className="w-10 h-10 rounded-lg border border-white/20 hover:bg-white/5 transition flex items-center justify-center">
                                <i className="fa-solid fa-xmark"></i>
                            </button>
                        </div>

                        <div className="space-y-4">
                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <label className="flex items-center justify-between">
                                    <span className="text-sm text-slate-300">Email Notifications</span>
                                    <input type="checkbox" className="custom-checkbox" defaultChecked />
                                </label>
                            </div>

                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <label className="flex items-center justify-between">
                                    <span className="text-sm text-slate-300">SMS Alerts</span>
                                    <input type="checkbox" className="custom-checkbox" />
                                </label>
                            </div>

                            <div className="flex gap-3">
                                <button className="flex-1 py-3 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-xl font-bold text-black">Save</button>
                                <button onClick={onClose} className="px-6 py-3 border border-white/20 rounded-xl text-slate-300">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        // Profile Dropdown Component
        const ProfileDropdown = ({ user, onLogout, onOpenSettings, onOpenSecurity, onOpenNotifications, profileEmoji, hasUnreadNotifications }) => {
            const [isOpen, setIsOpen] = useState(false);

            return (
                <div className="relative">
                    <button 
                        onClick={() => setIsOpen(!isOpen)}
                        className="flex items-center gap-3 px-4 py-2 rounded-xl bg-cyber-blue/10 border border-cyber-blue/30 hover:bg-cyber-blue/20 hover:shadow-[0_0_20px_rgba(0,240,255,0.3)] transition-all group"
                    >
                        <div className="w-8 h-8 rounded-full bg-gradient-to-br from-cyber-blue to-cyber-purple flex items-center justify-center text-2xl border border-cyber-blue/50">
                            {profileEmoji}
                        </div>
                        <div className="text-left hidden sm:block">
                            <p className="text-xs text-slate-400 font-mono">LOGGED IN</p>
                            <p className="text-sm font-bold text-white">{user.displayName || user.email}</p>
                        </div>
                        <i className={`fa-solid fa-chevron-down text-cyber-blue text-xs transition-transform ${isOpen ? 'rotate-180' : ''}`}></i>
                    </button>

                    {isOpen && (
                        <>
                            <div className="fixed inset-0 z-40" onClick={() => setIsOpen(false)}></div>
                            <div className="absolute right-0 mt-2 w-64 glass-panel rounded-xl border border-white/10 shadow-xl z-50 animate-slideUp">
                                <div className="p-4 border-b border-white/10">
                                    <div className="flex items-center gap-3">
                                        <div className="w-12 h-12 rounded-full bg-gradient-to-br from-cyber-blue to-cyber-purple flex items-center justify-center border border-cyber-blue/50 text-3xl">
                                            {profileEmoji}
                                        </div>
                                        <div className="flex-1">
                                            <p className="font-bold text-white">{user.displayName || 'User'}</p>
                                            <p className="text-xs text-slate-400 truncate">{user.email}</p>
                                        </div>
                                    </div>
                                </div>

                                <div className="p-2">
                                    <button 
                                        onClick={() => {
                                            setIsOpen(false);
                                            onOpenSettings();
                                        }}
                                        className="w-full p-3 rounded-lg hover:bg-white/5 transition-all flex items-center gap-3 text-slate-300"
                                    >
                                        <i className="fa-solid fa-user-gear text-cyber-blue"></i>
                                        <span>Account Settings</span>
                                    </button>
                                    <button 
                                        onClick={() => {
                                            setIsOpen(false);
                                            onOpenSecurity();
                                        }}
                                        className="w-full p-3 rounded-lg hover:bg-white/5 transition-all flex items-center gap-3 text-slate-300"
                                    >
                                        <i className="fa-solid fa-shield text-cyber-purple"></i>
                                        <span>Security</span>
                                    </button>
                                    <button 
                                        onClick={() => {
                                            setIsOpen(false);
                                            onOpenNotifications();
                                        }}
                                        className="w-full p-3 rounded-lg hover:bg-white/5 transition-all flex items-center gap-3 text-slate-300 relative"
                                    >
                                        <i className="fa-solid fa-bell text-yellow-400"></i>
                                        <span>Notifications</span>
                                        {hasUnreadNotifications && (
                                            <span className="ml-auto w-2 h-2 bg-red-500 rounded-full"></span>
                                        )}
                                    </button>
                                </div>

                                <div className="p-2 border-t border-white/10">
                                    <button 
                                        onClick={onLogout}
                                        className="w-full p-3 rounded-lg hover:bg-red-500/10 transition-all flex items-center gap-3 text-red-400 font-medium"
                                    >
                                        <i className="fa-solid fa-right-from-bracket"></i>
                                        <span>Logout</span>
                                    </button>
                                </div>
                            </div>
                        </>
                    )}
                </div>
            );
        };

        // Privacy Notice Modal
        const PrivacyNoticeModal = ({ onAccept, onClose }) => {
            return (
                <div className="modal-overlay animate-fadeIn">
                    <div className="modal-content glass-panel rounded-2xl p-8 animate-slideDown">
                        <div className="flex items-center gap-4 mb-6">
                            <div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-cyber-blue to-blue-600 flex items-center justify-center">
                                <i className="fa-solid fa-shield-halved text-3xl text-white"></i>
                            </div>
                            <div>
                                <h3 className="text-2xl font-bold text-white">Privacy & Security Notice</h3>
                                <p className="text-sm text-slate-400">Your data is protected</p>
                            </div>
                        </div>

                        <div className="space-y-4 mb-6 max-h-96 overflow-y-auto">
                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <div className="flex items-start gap-3">
                                    <i className="fa-solid fa-lock text-cyber-blue text-xl mt-1"></i>
                                    <div>
                                        <h4 className="font-bold text-white mb-2">End-to-End Encryption</h4>
                                        <p className="text-sm text-slate-300">All reports are encrypted using AES-256 encryption before transmission. Your data is protected both in transit and at rest.</p>
                                    </div>
                                </div>
                            </div>

                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <div className="flex items-start gap-3">
                                    <i className="fa-solid fa-user-shield text-cyber-blue text-xl mt-1"></i>
                                    <div>
                                        <h4 className="font-bold text-white mb-2">Data Privacy</h4>
                                        <p className="text-sm text-slate-300">Your personal information is only accessible to authorized security personnel. We never share your data with third parties.</p>
                                    </div>
                                </div>
                            </div>

                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <div className="flex items-start gap-3">
                                    <i className="fa-solid fa-eye-slash text-cyber-blue text-xl mt-1"></i>
                                    <div>
                                        <h4 className="font-bold text-white mb-2">Anonymous Reporting</h4>
                                        <p className="text-sm text-slate-300">You can submit reports anonymously. No personally identifiable information will be stored if you choose this option.</p>
                                    </div>
                                </div>
                            </div>

                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <div className="flex items-start gap-3">
                                    <i className="fa-solid fa-database text-cyber-blue text-xl mt-1"></i>
                                    <div>
                                        <h4 className="font-bold text-white mb-2">Data Retention</h4>
                                        <p className="text-sm text-slate-300">Reports are retained for 90 days after case closure. You can request deletion at any time by contacting our security team.</p>
                                    </div>
                                </div>
                            </div>

                            <div className="p-4 rounded-lg bg-white/5 border border-white/10">
                                <div className="flex items-start gap-3">
                                    <i className="fa-solid fa-certificate text-cyber-blue text-xl mt-1"></i>
                                    <div>
                                        <h4 className="font-bold text-white mb-2">Compliance</h4>
                                        <p className="text-sm text-slate-300">We comply with GDPR, CCPA, and SOC 2 Type II standards. Our security practices are audited annually.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="flex gap-4">
                            <button
                                onClick={onAccept}
                                className="flex-1 py-3 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-xl font-bold text-black hover:shadow-[0_0_30px_rgba(0,240,255,0.5)] transition-all"
                            >
                                <i className="fa-solid fa-check mr-2"></i>
                                I Understand & Accept
                            </button>
                            <button
                                onClick={onClose}
                                className="px-6 py-3 border border-white/20 rounded-xl font-bold text-slate-300 hover:bg-white/5 transition-all"
                            >
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // CAPTCHA Component
        const CaptchaChallenge = ({ onVerify }) => {
            const [verified, setVerified] = useState(false);
            const [challenge, setChallenge] = useState('');
            const [userInput, setUserInput] = useState('');
            const [attempts, setAttempts] = useState(0);

            useEffect(() => {
                generateChallenge();
            }, []);

            const generateChallenge = () => {
                const num1 = Math.floor(Math.random() * 10) + 1;
                const num2 = Math.floor(Math.random() * 10) + 1;
                setChallenge({ num1, num2, answer: num1 + num2 });
                setUserInput('');
            };

            const handleVerify = () => {
                if (parseInt(userInput) === challenge.answer) {
                    setVerified(true);
                    onVerify(true);
                } else {
                    setAttempts(prev => prev + 1);
                    if (attempts >= 2) {
                        alert('Too many failed attempts. Please refresh and try again.');
                    } else {
                        alert('Incorrect answer. Please try again.');
                        generateChallenge();
                    }
                }
            };

            if (verified) {
                return (
                    <div className="p-4 rounded-xl bg-green-500/10 border border-green-500/30 flex items-center gap-3">
                        <i className="fa-solid fa-check-circle text-2xl text-green-400"></i>
                        <div>
                            <p className="font-bold text-green-400">Verified</p>
                            <p className="text-xs text-slate-400">Bot protection passed</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="captcha-box rounded-xl p-6">
                    <div className="flex items-center gap-3 mb-4">
                        <i className="fa-solid fa-robot text-2xl text-cyber-blue"></i>
                        <div>
                            <h4 className="font-bold text-white">Verify You're Human</h4>
                            <p className="text-xs text-slate-400">Bot protection enabled</p>
                        </div>
                    </div>

                    <div className="space-y-4">
                        <div className="p-4 rounded-lg bg-black/40 border border-white/10">
                            <p className="text-white font-mono text-lg text-center">
                                {challenge.num1} + {challenge.num2} = ?
                            </p>
                        </div>

                        <div className="flex gap-3">
                            <input
                                type="number"
                                value={userInput}
                                onChange={(e) => setUserInput(e.target.value)}
                                placeholder="Enter answer"
                                className="flex-1 bg-black/40 border border-white/10 rounded-lg p-3 text-white placeholder-slate-600 focus:border-cyber-blue focus:outline-none transition-colors"
                                onKeyPress={(e) => e.key === 'Enter' && handleVerify()}
                            />
                            <button
                                onClick={handleVerify}
                                className="px-6 py-3 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-lg font-bold text-black hover:shadow-[0_0_20px_rgba(0,240,255,0.3)] transition"
                            >
                                Verify
                            </button>
                        </div>

                        <p className="text-xs text-slate-500 text-center">
                            Attempts: {attempts}/3
                        </p>
                    </div>
                </div>
            );
        };

        const StatusTracker = ({ reportId, currentStatus, submittedDate }) => {
            const [progressHeight, setProgressHeight] = useState(0);

            const statuses = [
                {
                    id: 'submitted',
                    label: 'Submitted',
                    icon: 'fa-check',
                    color: 'from-green-500 to-green-600',
                    description: 'Report received and encrypted',
                    timestamp: submittedDate
                },
                {
                    id: 'under_review',
                    label: 'Under Review',
                    icon: 'fa-magnifying-glass',
                    color: 'from-blue-500 to-blue-600',
                    description: 'Security team analyzing incident',
                    timestamp: currentStatus === 'under_review' || currentStatus === 'action_taken' || currentStatus === 'closed' ? 'Just now' : null
                },
                {
                    id: 'action_taken',
                    label: 'Action Taken',
                    icon: 'fa-shield-halved',
                    color: 'from-purple-500 to-purple-600',
                    description: 'Containment measures deployed',
                    timestamp: currentStatus === 'action_taken' || currentStatus === 'closed' ? 'Just now' : null
                },
                {
                    id: 'closed',
                    label: 'Closed',
                    icon: 'fa-circle-check',
                    color: 'from-cyber-blue to-blue-600',
                    description: 'Incident resolved',
                    timestamp: currentStatus === 'closed' ? 'Just now' : null
                }
            ];

            const currentIndex = statuses.findIndex(s => s.id === currentStatus);

            useEffect(() => {
                if (currentIndex >= 0) {
                    const height = (currentIndex / (statuses.length - 1)) * 100;
                    setTimeout(() => setProgressHeight(height), 100);
                }
            }, [currentIndex]);

            return (
                <div className="glass-panel rounded-2xl p-8 animate-slideDown">
                    <div className="flex items-center justify-between mb-6">
                        <div>
                            <h3 className="text-xl font-bold text-white mb-1">Report Status</h3>
                            <p className="text-sm text-slate-400 font-mono">ID: {reportId}</p>
                        </div>
                        <button 
                            onClick={() => navigator.clipboard.writeText(reportId)}
                            className="px-4 py-2 border border-white/20 rounded-lg text-sm text-slate-300 hover:bg-white/5 transition"
                        >
                            <i className="fa-solid fa-copy mr-2"></i>Copy ID
                        </button>
                    </div>

                    <div className="status-timeline relative">
                        <div 
                            className="progress-line transition-all duration-1000 ease-out"
                            style={{ 
                                height: `${progressHeight}%`,
                                top: '40px'
                            }}
                        ></div>

                        {statuses.map((status, index) => {
                            const isCompleted = index <= currentIndex;
                            const isActive = index === currentIndex;
                            
                            return (
                                <div 
                                    key={status.id}
                                    className={`status-step ${isActive ? 'active' : ''}`}
                                >
                                    <div className={`
                                        status-icon border-2
                                        ${isCompleted 
                                            ? `bg-gradient-to-br ${status.color} border-transparent` 
                                            : 'bg-black/40 border-white/20'
                                        }
                                    `}>
                                        <i className={`fa-solid ${status.icon} ${isCompleted ? 'text-white' : 'text-slate-600'}`}></i>
                                    </div>
                                    
                                    <div className={`${isCompleted ? 'opacity-100' : 'opacity-50'}`}>
                                        <div className="flex items-center gap-3 mb-1">
                                            <h4 className={`font-bold ${isActive ? 'text-cyber-blue' : 'text-white'}`}>
                                                {status.label}
                                            </h4>
                                            {isActive && (
                                                <span className="px-2 py-1 bg-cyber-blue/20 border border-cyber-blue/50 rounded text-xs text-cyber-blue font-mono">
                                                    CURRENT
                                                </span>
                                            )}
                                        </div>
                                        <p className="text-sm text-slate-400 mb-1">{status.description}</p>
                                        {status.timestamp && (
                                            <p className="text-xs text-slate-500 font-mono">
                                                <i className="fa-solid fa-clock mr-1"></i>
                                                {status.timestamp}
                                            </p>
                                        )}
                                    </div>
                                </div>
                            );
                        })}
                    </div>

                    <div className="mt-6 p-4 rounded-lg bg-white/5 border border-white/10">
                        <div className="flex items-start gap-3">
                            <i className="fa-solid fa-bell text-cyber-blue mt-1"></i>
                            <div>
                                <p className="text-sm text-white font-semibold mb-1">Email notifications enabled</p>
                                <p className="text-xs text-slate-400">You'll receive updates as the status changes</p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const EvidenceModal = ({ files, onClose }) => {
            const handleDownload = (file) => {
                alert(`Downloading: ${file.name}`);
            };

            return (
                <div className="modal-overlay animate-fadeIn" onClick={onClose}>
                    <div className="modal-content glass-panel rounded-2xl p-8 animate-slideDown" onClick={(e) => e.stopPropagation()}>
                        <div className="flex items-center justify-between mb-6">
                            <h3 className="text-2xl font-bold text-white">Evidence Files</h3>
                            <button 
                                onClick={onClose}
                                className="w-10 h-10 rounded-lg border border-white/20 hover:bg-white/5 transition flex items-center justify-center"
                            >
                                <i className="fa-solid fa-xmark text-xl"></i>
                            </button>
                        </div>

                        {files.length === 0 ? (
                            <div className="text-center py-8">
                                <i className="fa-solid fa-folder-open text-5xl text-slate-600 mb-4"></i>
                                <p className="text-slate-400">No evidence files attached</p>
                            </div>
                        ) : (
                            <div className="space-y-3">
                                {files.map((file, index) => (
                                    <div key={index} className="flex items-center justify-between p-4 rounded-lg bg-white/5 border border-white/10 hover:border-cyber-blue/30 transition">
                                        <div className="flex items-center gap-3">
                                            <div className="w-12 h-12 rounded-lg bg-gradient-to-br from-cyber-blue to-blue-600 flex items-center justify-center">
                                                <i className="fa-solid fa-file text-white"></i>
                                            </div>
                                            <div>
                                                <p className="text-white font-medium">{file.name}</p>
                                                <p className="text-xs text-slate-400">{file.size}</p>
                                            </div>
                                        </div>
                                        <button
                                            onClick={() => handleDownload(file)}
                                            className="px-4 py-2 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-lg text-black font-bold hover:shadow-[0_0_20px_rgba(0,240,255,0.3)] transition"
                                        >
                                            <i className="fa-solid fa-download mr-2"></i>
                                            Download
                                        </button>
                                    </div>
                                ))}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const ReportHistory = ({ reports, onViewReport, onEditReport }) => {
            const getStatusColor = (status) => {
                switch(status) {
                    case 'submitted': return 'text-green-400 bg-green-500/20 border-green-500/50';
                    case 'under_review': return 'text-blue-400 bg-blue-500/20 border-blue-500/50';
                    case 'action_taken': return 'text-purple-400 bg-purple-500/20 border-purple-500/50';
                    case 'closed': return 'text-cyber-blue bg-cyber-blue/20 border-cyber-blue/50';
                    default: return 'text-slate-400 bg-slate-500/20 border-slate-500/50';
                }
            };

            const getSeverityColor = (severity) => {
                switch(severity) {
                    case 'high': return 'text-red-400 bg-red-500/20 border-red-500/50';
                    case 'medium': return 'text-yellow-400 bg-yellow-500/20 border-yellow-500/50';
                    case 'low': return 'text-green-400 bg-green-500/20 border-green-500/50';
                    default: return 'text-slate-400 bg-slate-500/20 border-slate-500/50';
                }
            };

            if (reports.length === 0) {
                return (
                    <div className="glass-panel rounded-2xl p-12 text-center">
                        <i className="fa-solid fa-inbox text-6xl text-slate-600 mb-4"></i>
                        <h3 className="text-xl font-bold text-white mb-2">No Reports Yet</h3>
                        <p className="text-slate-400">Your submitted reports will appear here</p>
                    </div>
                );
            }

            return (
                <div className="space-y-4">
                    {reports.map((report) => (
                        <div key={report.id} className="glass-panel rounded-2xl p-6 hover:border-cyber-blue/30 transition animate-slideUp">
                            <div className="flex items-start justify-between mb-4">
                                <div className="flex-1">
                                    <div className="flex items-center gap-3 mb-2">
                                        <h3 className="text-lg font-bold text-white font-mono">{report.id}</h3>
                                        <span className={`px-3 py-1 rounded-full border text-xs font-mono ${getStatusColor(report.status)}`}>
                                            {report.status.replace('_', ' ').toUpperCase()}
                                        </span>
                                        <span className={`px-3 py-1 rounded-full border text-xs font-mono ${getSeverityColor(report.data.severity)}`}>
                                            {report.data.severity.toUpperCase()}
                                        </span>
                                    </div>
                                    <p className="text-sm text-slate-400 mb-3">
                                        <i className="fa-solid fa-clock mr-2"></i>
                                        {report.submittedDate}
                                    </p>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 mb-4">
                                        <div>
                                            <p className="text-xs text-slate-500 mb-1">Incident Type</p>
                                            <p className="text-sm text-white">{report.data.incidentType}</p>
                                        </div>
                                        <div>
                                            <p className="text-xs text-slate-500 mb-1">Affected Assets</p>
                                            <p className="text-sm text-white">{report.data.affectedAssets || 'N/A'}</p>
                                        </div>
                                    </div>
                                    {report.data.description && (
                                        <p className="text-sm text-slate-300 line-clamp-2">{report.data.description}</p>
                                    )}
                                </div>
                            </div>

                            <div className="flex gap-3 pt-4 border-t border-white/10">
                                <button
                                    onClick={() => onViewReport(report)}
                                    className="flex-1 px-4 py-2 border border-white/20 rounded-lg text-sm text-slate-300 hover:bg-white/5 transition"
                                >
                                    <i className="fa-solid fa-eye mr-2"></i>
                                    View Details
                                </button>
                                {report.files && report.files.length > 0 && (
                                    <button
                                        onClick={() => onViewReport(report, true)}
                                        className="flex-1 px-4 py-2 border border-white/20 rounded-lg text-sm text-slate-300 hover:bg-white/5 transition"
                                    >
                                        <i className="fa-solid fa-download mr-2"></i>
                                        Evidence ({report.files.length})
                                    </button>
                                )}
                                {report.status === 'submitted' && (
                                    <button
                                        onClick={() => onEditReport(report)}
                                        className="flex-1 px-4 py-2 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-lg text-black font-bold hover:shadow-[0_0_20px_rgba(0,240,255,0.3)] transition"
                                    >
                                        <i className="fa-solid fa-pen-to-square mr-2"></i>
                                        Edit Report
                                    </button>
                                )}
                            </div>
                        </div>
                    ))}
                </div>
            );
        };

        const ReportPage = () => {
            const [activeTab, setActiveTab] = useState('new');
            const [formData, setFormData] = useState({
                incidentType: 'phishing',
                severity: 'medium',
                affectedAssets: '',
                description: '',
                ipAddress: '',
                timestamp: '',
                reporter: '',
                email: '',
                anonymous: false,
                containment: false
            });

            const [uploadedFiles, setUploadedFiles] = useState([]);
            const [isDragging, setIsDragging] = useState(false);
            const [submitted, setSubmitted] = useState(false);
            const [showStatusTracker, setShowStatusTracker] = useState(false);
            const [currentReport, setCurrentReport] = useState(null);
            const [reportHistory, setReportHistory] = useState([]);
            const [showEvidenceModal, setShowEvidenceModal] = useState(false);
            const [selectedReportFiles, setSelectedReportFiles] = useState([]);
            const [editingReport, setEditingReport] = useState(null);
            const [showPrivacyNotice, setShowPrivacyNotice] = useState(false);
            const [privacyAccepted, setPrivacyAccepted] = useState(false);
            const [captchaVerified, setCaptchaVerified] = useState(false);
            const [isLoading, setIsLoading] = useState(false);
            const fileInputRef = useRef(null);

            // Load reports from Firebase on component mount
            useEffect(() => {
                loadReportsFromFirebase();
            }, []);

            const loadReportsFromFirebase = () => {
                setIsLoading(true);
                const reportsRef = firebase.database().ref('reports');
                
                reportsRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        const reportsArray = Object.keys(data).map(key => ({
                            firebaseKey: key,
                            ...data[key]
                        }));
                        // Sort by timestamp (newest first)
                        reportsArray.sort((a, b) => new Date(b.submittedTimestamp) - new Date(a.submittedTimestamp));
                        setReportHistory(reportsArray);
                    }
                    setIsLoading(false);
                });
            };

            const generateReportId = () => {
                const prefix = 'CS';
                const timestamp = Date.now().toString(36).toUpperCase();
                const random = Math.random().toString(36).substring(2, 6).toUpperCase();
                return `${prefix}-${timestamp}-${random}`;
            };

            const handleInputChange = (e) => {
                const { name, value, type, checked } = e.target;
                setFormData(prev => ({
                    ...prev,
                    [name]: type === 'checkbox' ? checked : value
                }));
            };

            const handleFileUpload = (files) => {
                const newFiles = Array.from(files).map(file => ({
                    name: file.name,
                    size: (file.size / 1024).toFixed(2) + ' KB',
                    type: file.type
                }));
                setUploadedFiles(prev => [...prev, ...newFiles]);
            };

            const handleDrop = (e) => {
                e.preventDefault();
                setIsDragging(false);
                handleFileUpload(e.dataTransfer.files);
            };

            const saveReportToFirebase = async (reportData) => {
                try {
                    const reportsRef = firebase.database().ref('reports');
                    await reportsRef.push(reportData);
                    return true;
                } catch (error) {
                    console.error('Error saving to Firebase:', error);
                    alert('Error saving report. Please try again.');
                    return false;
                }
            };

            const updateReportInFirebase = async (firebaseKey, reportData) => {
                try {
                    const reportRef = firebase.database().ref(`reports/${firebaseKey}`);
                    await reportRef.update(reportData);
                    return true;
                } catch (error) {
                    console.error('Error updating Firebase:', error);
                    alert('Error updating report. Please try again.');
                    return false;
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();

                // Security checks
                if (!privacyAccepted) {
                    setShowPrivacyNotice(true);
                    return;
                }

                if (!captchaVerified) {
                    alert('Please complete the CAPTCHA verification');
                    return;
                }

                setIsLoading(true);
                
                if (editingReport) {
                    const updatedData = {
                        data: formData,
                        files: uploadedFiles,
                        lastModified: new Date().toISOString()
                    };

                    const success = await updateReportInFirebase(editingReport.firebaseKey, updatedData);
                    
                    if (success) {
                        setEditingReport(null);
                        alert('Report updated successfully!');
                    }
                } else {
                    const reportId = generateReportId();
                    const submittedDate = new Date().toLocaleString('en-US', {
                        month: 'short',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });

                    const newReport = {
                        id: reportId,
                        status: 'submitted',
                        submittedDate: submittedDate,
                        submittedTimestamp: new Date().toISOString(),
                        data: formData,
                        files: uploadedFiles
                    };

                    const success = await saveReportToFirebase(newReport);
                    
                    if (success) {
                        setCurrentReport(newReport);
                        setSubmitted(true);
                        setShowStatusTracker(true);

                        setTimeout(() => {
                            setCurrentReport(prev => ({ ...prev, status: 'under_review' }));
                        }, 3000);

                        setTimeout(() => {
                            setSubmitted(false);
                        }, 4000);
                    }
                }

                setFormData({
                    incidentType: 'phishing',
                    severity: 'medium',
                    affectedAssets: '',
                    description: '',
                    ipAddress: '',
                    timestamp: '',
                    reporter: '',
                    email: '',
                    anonymous: false,
                    containment: false
                });
                setUploadedFiles([]);
                setCaptchaVerified(false);
                setIsLoading(false);
            };

            const handleNewReport = () => {
                setShowStatusTracker(false);
                setCurrentReport(null);
                setEditingReport(null);
                setActiveTab('new');
                setFormData({
                    incidentType: 'phishing',
                    severity: 'medium',
                    affectedAssets: '',
                    description: '',
                    ipAddress: '',
                    timestamp: '',
                    reporter: '',
                    email: '',
                    anonymous: false,
                    containment: false
                });
                setUploadedFiles([]);
                setCaptchaVerified(false);
            };

            const handleViewReport = (report, showEvidence = false) => {
                if (showEvidence) {
                    setSelectedReportFiles(report.files || []);
                    setShowEvidenceModal(true);
                } else {
                    setCurrentReport(report);
                    setShowStatusTracker(true);
                    setActiveTab('new');
                }
            };

            const handleEditReport = (report) => {
                setEditingReport(report);
                setFormData(report.data);
                setUploadedFiles(report.files || []);
                setActiveTab('new');
                setShowStatusTracker(false);
                setCaptchaVerified(true); // Skip CAPTCHA for edits
            };

            const removeFile = (index) => {
                setUploadedFiles(prev => prev.filter((_, i) => i !== index));
            };

            const handlePrivacyAccept = () => {
                setPrivacyAccepted(true);
                setShowPrivacyNotice(false);
            };

            return (
                <div className="max-w-5xl mx-auto animate-fadeIn">
                    {/* Loading Indicator */}
                    {isLoading && (
                        <div className="fixed top-0 left-0 right-0 bottom-0 bg-black/80 backdrop-blur-sm z-[9999] flex items-center justify-center">
                            <div className="text-center">
                                <i className="fa-solid fa-spinner fa-spin text-6xl text-cyber-blue mb-4"></i>
                                <p className="text-white font-bold">Processing...</p>
                            </div>
                        </div>
                    )}

                    {/* Security & Privacy Banner */}
                    <div className="encryption-badge rounded-2xl p-4 mb-6 flex items-center justify-between animate-fadeIn">
                        <div className="flex items-center gap-4">
                            <i className="fa-solid fa-shield-halved text-3xl text-cyber-blue shield-icon"></i>
                            <div>
                                <h3 className="font-bold text-white flex items-center gap-2">
                                    <i className="fa-solid fa-lock text-cyber-blue"></i>
                                    Secure Submission Protected
                                </h3>
                                <p className="text-sm text-slate-300">AES-256 Encryption â€¢ Zero-Knowledge Architecture â€¢ SOC 2 Compliant</p>
                            </div>
                        </div>
                        <button
                            onClick={() => setShowPrivacyNotice(true)}
                            className="px-4 py-2 border border-cyber-blue/50 rounded-lg text-sm text-cyber-blue hover:bg-cyber-blue/10 transition"
                        >
                            <i className="fa-solid fa-info-circle mr-2"></i>
                            Privacy Info
                        </button>
                    </div>

                    <div className="glass-panel rounded-2xl p-2 mb-6 flex gap-2 animate-fadeIn">
                        <button
                            onClick={() => {
                                setActiveTab('new');
                                setShowStatusTracker(false);
                                setEditingReport(null);
                            }}
                            className={`flex-1 px-6 py-3 rounded-xl font-bold transition-all tab-button ${
                                activeTab === 'new' 
                                    ? 'bg-gradient-to-r from-cyber-blue to-blue-600 text-black active' 
                                    : 'text-slate-400 hover:text-white hover:bg-white/5'
                            }`}
                        >
                            <i className="fa-solid fa-plus mr-2"></i>
                            New Report
                        </button>
                        <button
                            onClick={() => setActiveTab('history')}
                            className={`flex-1 px-6 py-3 rounded-xl font-bold transition-all tab-button ${
                                activeTab === 'history' 
                                    ? 'bg-gradient-to-r from-cyber-blue to-blue-600 text-black active' 
                                    : 'text-slate-400 hover:text-white hover:bg-white/5'
                            }`}
                        >
                            <i className="fa-solid fa-clock-rotate-left mr-2"></i>
                            Report History ({reportHistory.length})
                        </button>
                    </div>

                    {activeTab === 'history' && (
                        <ReportHistory 
                            reports={reportHistory}
                            onViewReport={handleViewReport}
                            onEditReport={handleEditReport}
                        />
                    )}

                    {activeTab === 'new' && (
                        <>
                            {submitted && (
                                <div className="mb-6 p-4 rounded-xl bg-green-500/10 border border-green-500/30 flex items-center gap-3 animate-fadeIn">
                                    <i className="fa-solid fa-check-circle text-2xl text-green-400"></i>
                                    <div className="flex-1">
                                        <h4 className="font-bold text-green-400">Report Submitted Successfully</h4>
                                        <p className="text-sm text-slate-400">Your incident report has been encrypted and saved to the database.</p>
                                    </div>
                                    {currentReport && (
                                        <div className="px-4 py-2 bg-black/30 rounded-lg">
                                            <p className="text-xs text-slate-400 mb-1">Report ID</p>
                                            <p className="font-mono font-bold text-cyber-blue">{currentReport.id}</p>
                                        </div>
                                    )}
                                </div>
                            )}

                            {showStatusTracker && currentReport && (
                                <div className="mb-6">
                                    <StatusTracker 
                                        reportId={currentReport.id}
                                        currentStatus={currentReport.status}
                                        submittedDate={currentReport.submittedDate}
                                    />
                                </div>
                            )}

                            {showStatusTracker && (
                                <div className="mb-6 flex justify-center">
                                    <button 
                                        onClick={handleNewReport}
                                        className="px-6 py-3 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-xl font-bold text-black hover:shadow-[0_0_30px_rgba(0,240,255,0.5)] transition-all"
                                    >
                                        <i className="fa-solid fa-plus mr-2"></i>
                                        Submit New Report
                                    </button>
                                </div>
                            )}

                            {!showStatusTracker && (
                                <>
                                    <div className="glass-panel rounded-2xl p-8 mb-6 animate-fadeIn">
                                        <div className="flex items-center gap-4 mb-4">
                                            <div className="w-16 h-16 rounded-2xl bg-gradient-to-br from-cyber-blue to-blue-600 flex items-center justify-center">
                                                <i className={`fa-solid ${editingReport ? 'fa-pen-to-square' : 'fa-file-shield'} text-3xl text-white`}></i>
                                            </div>
                                            <div>
                                                <h2 className="text-3xl font-bold text-white neon-text-blue">
                                                    {editingReport ? 'Edit Threat Report' : 'Threat Report Portal'}
                                                </h2>
                                                <p className="text-slate-400 mt-1">
                                                    {editingReport 
                                                        ? `Editing Report ID: ${editingReport.id}` 
                                                        : 'Submit cybersecurity incidents for immediate investigation'}
                                                </p>
                                            </div>
                                        </div>
                                        <div className="flex gap-4 text-sm flex-wrap">
                                            <div className="flex items-center gap-2 text-slate-400">
                                                <i className="fa-solid fa-lock text-cyber-blue"></i>
                                                <span>End-to-End Encrypted</span>
                                            </div>
                                            <div className="flex items-center gap-2 text-slate-400">
                                                <i className="fa-solid fa-clock text-cyber-blue"></i>
                                                <span>24/7 Monitoring</span>
                                            </div>
                                            <div className="flex items-center gap-2 text-slate-400">
                                                <i className="fa-solid fa-chart-line text-cyber-blue"></i>
                                                <span>Real-time Tracking</span>
                                            </div>
                                            <div className="flex items-center gap-2 text-slate-400">
                                                <i className="fa-solid fa-shield-halved text-cyber-blue"></i>
                                                <span>Bot Protection</span>
                                            </div>
                                        </div>
                                    </div>

                                    <form onSubmit={handleSubmit} className="space-y-6">
                                        <div className="glass-panel rounded-2xl p-8 animate-slideUp">
                                            <h3 className="text-xl font-bold text-white mb-6 flex items-center gap-2">
                                                <i className="fa-solid fa-circle-info text-cyber-blue"></i>
                                                Incident Details
                                            </h3>

                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div>
                                                    <label className="block text-xs font-mono text-slate-400 mb-2 uppercase tracking-wider">Incident Type *</label>
                                                    <select 
                                                        name="incidentType"
                                                        value={formData.incidentType}
                                                        onChange={handleInputChange}
                                                        className="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white focus:border-cyber-blue focus:outline-none transition-colors"
                                                    >
                                                        <option value="phishing">Phishing Attempt</option>
                                                        <option value="malware">Malware / Ransomware</option>
                                                        <option value="ddos">DDoS Attack</option>
                                                        <option value="breach">Data Breach</option>
                                                        <option value="unauthorized">Unauthorized Access</option>
                                                        <option value="suspicious">Suspicious Activity</option>
                                                        <option value="other">Other</option>
                                                    </select>
                                                </div>

                                                <div>
                                                    <label className="block text-xs font-mono text-slate-400 mb-2 uppercase tracking-wider">Severity Level *</label>
                                                    <div className="grid grid-cols-3 gap-3">
                                                        {['low', 'medium', 'high'].map(level => (
                                                            <button
                                                                key={level}
                                                                type="button"
                                                                onClick={() => setFormData(prev => ({ ...prev, severity: level }))}
                                                                className={`p-3 rounded-lg border transition-all ${
                                                                    formData.severity === level
                                                                        ? level === 'high' ? 'bg-red-500/20 border-red-500 text-red-400' :
                                                                          level === 'medium' ? 'bg-yellow-500/20 border-yellow-500 text-yellow-400' :
                                                                          'bg-green-500/20 border-green-500 text-green-400'
                                                                        : 'border-white/10 text-slate-400 hover:border-white/30'
                                                                }`}
                                                            >
                                                                {level.charAt(0).toUpperCase() + level.slice(1)}
                                                            </button>
                                                        ))}
                                                    </div>
                                                </div>

                                                <div>
                                                    <label className="block text-xs font-mono text-slate-400 mb-2 uppercase tracking-wider">Affected Assets *</label>
                                                    <input 
                                                        type="text" 
                                                        name="affectedAssets"
                                                        value={formData.affectedAssets}
                                                        onChange={handleInputChange}
                                                        placeholder="e.g. Workstation-01, HR Database, Email Server" 
                                                        className="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white placeholder-slate-600 focus:border-cyber-blue focus:outline-none transition-colors" 
                                                    />
                                                </div>

                                                <div>
                                                    <label className="block text-xs font-mono text-slate-400 mb-2 uppercase tracking-wider">IP Address (if known)</label>
                                                    <input 
                                                        type="text" 
                                                        name="ipAddress"
                                                        value={formData.ipAddress}
                                                        onChange={handleInputChange}
                                                        placeholder="e.g. 192.168.1.100" 
                                                        className="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white placeholder-slate-600 focus:border-cyber-blue focus:outline-none transition-colors font-mono" 
                                                    />
                                                </div>

                                                <div>
                                                    <label className="block text-xs font-mono text-slate-400 mb-2 uppercase tracking-wider">Incident Timestamp</label>
                                                    <input 
                                                        type="datetime-local" 
                                                        name="timestamp"
                                                        value={formData.timestamp}
                                                        onChange={handleInputChange}
                                                        className="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white focus:border-cyber-blue focus:outline-none transition-colors" 
                                                    />
                                                </div>

                                                <div className="md:col-span-2">
                                                    <label className="block text-xs font-mono text-slate-400 mb-2 uppercase tracking-wider">Description *</label>
                                                    <textarea 
                                                        name="description"
                                                        value={formData.description}
                                                        onChange={handleInputChange}
                                                        rows="5" 
                                                        placeholder="Provide detailed information about the incident..."
                                                        className="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white placeholder-slate-600 focus:border-cyber-blue focus:outline-none transition-colors resize-none"
                                                    ></textarea>
                                                </div>
                                            </div>
                                        </div>

                                        <div className="glass-panel rounded-2xl p-8 animate-slideUp" style={{ animationDelay: '0.1s' }}>
                                            <h3 className="text-xl font-bold text-white mb-6 flex items-center gap-2">
                                                <i className="fa-solid fa-paperclip text-cyber-blue"></i>
                                                Evidence & Attachments
                                            </h3>

                                            <div
                                                className={`file-upload-area border-2 border-dashed border-white/20 rounded-xl p-8 text-center cursor-pointer ${isDragging ? 'dragging' : ''}`}
                                                onDragOver={(e) => { e.preventDefault(); setIsDragging(true); }}
                                                onDragLeave={() => setIsDragging(false)}
                                                onDrop={handleDrop}
                                                onClick={() => fileInputRef.current?.click()}
                                            >
                                                <i className="fa-solid fa-cloud-arrow-up text-5xl text-cyber-blue mb-4"></i>
                                                <p className="text-white font-semibold mb-2">Drag & Drop files here</p>
                                                <p className="text-sm text-slate-400">or click to browse</p>
                                                <input 
                                                    ref={fileInputRef}
                                                    type="file" 
                                                    multiple 
                                                    className="hidden" 
                                                    onChange={(e) => handleFileUpload(e.target.files)}
                                                />
                                            </div>

                                            {uploadedFiles.length > 0 && (
                                                <div className="mt-4 space-y-2">
                                                    {uploadedFiles.map((file, index) => (
                                                        <div key={index} className="flex items-center justify-between p-3 rounded-lg bg-white/5 border border-white/10">
                                                            <div className="flex items-center gap-3">
                                                                <i className="fa-solid fa-file text-cyber-blue"></i>
                                                                <div>
                                                                    <p className="text-sm text-white">{file.name}</p>
                                                                    <p className="text-xs text-slate-500">{file.size}</p>
                                                                </div>
                                                            </div>
                                                            <button 
                                                                type="button"
                                                                onClick={() => removeFile(index)}
                                                                className="text-red-400 hover:text-red-300 transition"
                                                            >
                                                                <i className="fa-solid fa-xmark"></i>
                                                            </button>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>

                                        <div className="glass-panel rounded-2xl p-8 animate-slideUp" style={{ animationDelay: '0.2s' }}>
                                            <h3 className="text-xl font-bold text-white mb-6 flex items-center gap-2">
                                                <i className="fa-solid fa-user text-cyber-blue"></i>
                                                Reporter Information
                                            </h3>

                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div>
                                                    <label className="block text-xs font-mono text-slate-400 mb-2 uppercase tracking-wider">Full Name *</label>
                                                    <input 
                                                        type="text" 
                                                        name="reporter"
                                                        value={formData.reporter}
                                                        onChange={handleInputChange}
                                                        disabled={formData.anonymous}
                                                        placeholder="Name" 
                                                        className="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white placeholder-slate-600 focus:border-cyber-blue focus:outline-none transition-colors disabled:opacity-50 disabled:cursor-not-allowed" 
                                                    />
                                                </div>

                                                <div>
                                                    <label className="block text-xs font-mono text-slate-400 mb-2 uppercase tracking-wider">Email Address *</label>
                                                    <input 
                                                        type="email" 
                                                        name="email"
                                                        value={formData.email}
                                                        onChange={handleInputChange}
                                                        disabled={formData.anonymous}
                                                        placeholder="name@gmail.com" 
                                                        className="w-full bg-black/40 border border-white/10 rounded-lg p-3 text-white placeholder-slate-600 focus:border-cyber-blue focus:outline-none transition-colors disabled:opacity-50 disabled:cursor-not-allowed" 
                                                    />
                                                </div>
                                            </div>

                                            <div className="mt-6 space-y-4">
                                                <label className="flex items-center gap-3 cursor-pointer group">
                                                    <input 
                                                        type="checkbox" 
                                                        name="anonymous"
                                                        checked={formData.anonymous}
                                                        onChange={handleInputChange}
                                                        className="custom-checkbox"
                                                    />
                                                    <span className="text-sm text-slate-300 group-hover:text-white transition">Submit anonymously</span>
                                                </label>

                                                <label className="flex items-center gap-3 cursor-pointer group">
                                                    <input 
                                                        type="checkbox" 
                                                        name="containment"
                                                        checked={formData.containment}
                                                        onChange={handleInputChange}
                                                        className="custom-checkbox"
                                                    />
                                                    <span className="text-sm text-slate-300 group-hover:text-white transition">Request immediate containment measures</span>
                                                </label>
                                            </div>
                                        </div>

                                        {/* CAPTCHA & Security Section */}
                                        {!editingReport && (
                                            <div className="glass-panel rounded-2xl p-8 animate-slideUp" style={{ animationDelay: '0.3s' }}>
                                                <h3 className="text-xl font-bold text-white mb-6 flex items-center gap-2">
                                                    <i className="fa-solid fa-shield-halved text-cyber-blue"></i>
                                                    Security Verification
                                                </h3>

                                                <CaptchaChallenge onVerify={setCaptchaVerified} />

                                                <div className="mt-6 p-4 rounded-lg bg-white/5 border border-white/10">
                                                    <label className="flex items-start gap-3 cursor-pointer group">
                                                        <input 
                                                            type="checkbox" 
                                                            checked={privacyAccepted}
                                                            onChange={(e) => setPrivacyAccepted(e.target.checked)}
                                                            className="custom-checkbox mt-1"
                                                        />
                                                        <span className="text-sm text-slate-300 group-hover:text-white transition">
                                                            I have read and agree to the{' '}
                                                            <button
                                                                type="button"
                                                                onClick={() => setShowPrivacyNotice(true)}
                                                                className="text-cyber-blue hover:underline"
                                                            >
                                                                Privacy Policy & Security Notice
                                                            </button>
                                                        </span>
                                                    </label>
                                                </div>
                                            </div>
                                        )}

                                        <div className="flex gap-4">
                                            <button 
                                                type="submit"
                                                disabled={isLoading}
                                                className="flex-1 py-4 bg-gradient-to-r from-cyber-blue to-blue-600 rounded-xl font-bold text-black hover:shadow-[0_0_30px_rgba(0,240,255,0.5)] transition-all text-lg disabled:opacity-50 disabled:cursor-not-allowed"
                                            >
                                                <i className={`fa-solid ${isLoading ? 'fa-spinner fa-spin' : editingReport ? 'fa-check' : 'fa-lock'} mr-2`}></i>
                                                {isLoading ? 'PROCESSING...' : editingReport ? 'UPDATE REPORT' : 'ENCRYPT & SUBMIT REPORT'}
                                            </button>
                                            {editingReport && (
                                                <button 
                                                    type="button"
                                                    onClick={() => {
                                                        setEditingReport(null);
                                                        setFormData({
                                                            incidentType: 'phishing',
                                                            severity: 'medium',
                                                            affectedAssets: '',
                                                            description: '',
                                                            ipAddress: '',
                                                            timestamp: '',
                                                            reporter: '',
                                                            email: '',
                                                            anonymous: false,
                                                            containment: false
                                                        });
                                                        setUploadedFiles([]);
                                                    }}
                                                    className="px-8 py-4 border border-white/20 rounded-xl font-bold text-slate-300 hover:bg-white/5 transition-all"
                                                >
                                                    CANCEL
                                                </button>
                                            )}
                                        </div>
                                    </form>

                                    <div className="glass-panel rounded-2xl p-6 mt-6 animate-fadeIn">
                                        <div className="flex items-start gap-4">
                                            <i className="fa-solid fa-circle-question text-2xl text-cyber-blue mt-1"></i>
                                            <div>
                                                <h4 className="font-bold text-white mb-2">Need Help?</h4>
                                                <p className="text-sm text-slate-400">For urgent security incidents, contact our SOC hotline at <span className="text-cyber-blue font-mono">+1 (800) CYBER-911</span></p>
                                            </div>
                                        </div>
                                    </div>
                                </>
                            )}
                        </>
                    )}

                    {showEvidenceModal && (
                        <EvidenceModal 
                            files={selectedReportFiles}
                            onClose={() => setShowEvidenceModal(false)}
                        />
                    )}

                    {showPrivacyNotice && (
                        <PrivacyNoticeModal 
                            onAccept={handlePrivacyAccept}
                            onClose={() => setShowPrivacyNotice(false)}
                        />
                    )}
                </div>
            );
        };

        const App = ({ currentUser, profileEmoji, onLogout, onOpenSettings, onOpenSecurity, onOpenNotifications }) => {
            return (
                <div className="min-h-screen pl-0 lg:pl-64 transition-all duration-300">
                    <Sidebar activeTab="report" />
                    
                    <header className="h-20 border-b border-white/10 glass-panel sticky top-0 z-40 px-8 flex items-center justify-between">
                        <h2 className="text-xl font-bold text-white tracking-wide">
                            <span className="text-slate-500 font-light">OPS CENTER /</span> REPORT THREAT
                        </h2>

                        <div className="flex items-center gap-6">
                            {currentUser ? (
                                <ProfileDropdown 
                                    user={currentUser} 
                                    onLogout={onLogout}
                                    onOpenSettings={onOpenSettings}
                                    onOpenSecurity={onOpenSecurity}
                                    onOpenNotifications={onOpenNotifications}
                                    profileEmoji={profileEmoji}
                                    hasUnreadNotifications={false}
                                />
                            ) : (
                                <div className="w-10 h-10 rounded-full bg-gradient-to-tr from-cyber-blue to-blue-600 border border-white/20"></div>
                            )}
                        </div>
                    </header>

                    <main className="p-6 lg:p-8">
                        <ReportPage />
                    </main>
                </div>
            );
        };
        
        const Dashboard = () => {
            const [currentUser, setCurrentUser] = useState(null);
            const [profileEmoji, setProfileEmoji] = useState('ðŸš€');
            const [showSettingsModal, setShowSettingsModal] = useState(false);
            const [showSecurityModal, setShowSecurityModal] = useState(false);
            const [showNotificationsModal, setShowNotificationsModal] = useState(false);

            useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged((user) => {
                    if (user) {
                        setCurrentUser(user);
                        const savedEmoji = localStorage.getItem(`userEmoji_${user.uid}`);
                        if (savedEmoji) {
                            setProfileEmoji(savedEmoji);
                        }
                    } else {
                        setCurrentUser(null);
                        window.location.href = 'login.html';
                    }
                });

                return () => unsubscribe();
            }, []);

            const handleLogout = async () => {
                try {
                    await auth.signOut();
                    window.location.href = 'login.html';
                } catch (error) {
                    console.error('Logout error:', error);
                }
            };

            return (
                <App 
                    currentUser={currentUser}
                    profileEmoji={profileEmoji}
                    onLogout={handleLogout}
                    onOpenSettings={() => setShowSettingsModal(true)}
                    onOpenSecurity={() => setShowSecurityModal(true)}
                    onOpenNotifications={() => setShowNotificationsModal(true)}
                />
            );
        };

        ReactDOM.render(<Dashboard />, document.getElementById('root'));
    </script>
</body>
</html>
